[
  {
    "objectID": "index.html",
    "href": "index.html",
    "title": "Lab 6",
    "section": "",
    "text": "library(tidyverse)\n\n── Attaching core tidyverse packages ──────────────────────── tidyverse 2.0.0 ──\n✔ dplyr     1.1.4     ✔ readr     2.1.5\n✔ forcats   1.0.0     ✔ stringr   1.5.1\n✔ ggplot2   3.5.1     ✔ tibble    3.2.1\n✔ lubridate 1.9.4     ✔ tidyr     1.3.1\n✔ purrr     1.0.4     \n── Conflicts ────────────────────────────────────────── tidyverse_conflicts() ──\n✖ dplyr::filter() masks stats::filter()\n✖ dplyr::lag()    masks stats::lag()\nℹ Use the conflicted package (&lt;http://conflicted.r-lib.org/&gt;) to force all conflicts to become errors\n\nlibrary(readxl)\nlibrary(ggthemes)\nlibrary(tidymodels)\n\n── Attaching packages ────────────────────────────────────── tidymodels 1.3.0 ──\n✔ broom        1.0.7     ✔ rsample      1.2.1\n✔ dials        1.4.0     ✔ tune         1.3.0\n✔ infer        1.0.7     ✔ workflows    1.2.0\n✔ modeldata    1.4.0     ✔ workflowsets 1.1.0\n✔ parsnip      1.3.0     ✔ yardstick    1.3.2\n✔ recipes      1.1.1     \n── Conflicts ───────────────────────────────────────── tidymodels_conflicts() ──\n✖ scales::discard() masks purrr::discard()\n✖ dplyr::filter()   masks stats::filter()\n✖ recipes::fixed()  masks stringr::fixed()\n✖ dplyr::lag()      masks stats::lag()\n✖ yardstick::spec() masks readr::spec()\n✖ recipes::step()   masks stats::step()\n\nlibrary(vip)\n\n\nAttaching package: 'vip'\n\nThe following object is masked from 'package:utils':\n\n    vi\n\nlibrary(baguette)\nlibrary(glue)"
  },
  {
    "objectID": "index.html#question1",
    "href": "index.html#question1",
    "title": "Lab 6",
    "section": "Question#1",
    "text": "Question#1\n\nWhat does zero_q_freq represent?\nThe CAMELS dataset doc says that zero_q_freq is the fraction of days with zero stream flow over the observational period. So this means it is a measure of how often a stream at a given site runs dry.\n\nclim &lt;- read_delim(\"data/camels_clim.txt\", delim = \";\")\n\nRows: 671 Columns: 12\n── Column specification ────────────────────────────────────────────────────────\nDelimiter: \";\"\nchr (3): gauge_id, high_prec_timing, low_prec_timing\ndbl (9): p_mean, pet_mean, p_seasonality, frac_snow, aridity, high_prec_freq...\n\nℹ Use `spec()` to retrieve the full column specification for this data.\nℹ Specify the column types or set `show_col_types = FALSE` to quiet this message.\n\ngeol &lt;- read_delim(\"data/camels_geol.txt\", delim = \";\")\n\nRows: 671 Columns: 8\n── Column specification ────────────────────────────────────────────────────────\nDelimiter: \";\"\nchr (3): gauge_id, geol_1st_class, geol_2nd_class\ndbl (5): glim_1st_class_frac, glim_2nd_class_frac, carbonate_rocks_frac, geo...\n\nℹ Use `spec()` to retrieve the full column specification for this data.\nℹ Specify the column types or set `show_col_types = FALSE` to quiet this message.\n\nhydro &lt;- read_delim(\"data/camels_hydro.txt\", delim = \";\")\n\nRows: 671 Columns: 14\n── Column specification ────────────────────────────────────────────────────────\nDelimiter: \";\"\nchr  (1): gauge_id\ndbl (13): q_mean, runoff_ratio, slope_fdc, baseflow_index, stream_elas, q5, ...\n\nℹ Use `spec()` to retrieve the full column specification for this data.\nℹ Specify the column types or set `show_col_types = FALSE` to quiet this message.\n\nsoil &lt;- read_delim(\"data/camels_soil.txt\", delim = \";\")\n\nRows: 671 Columns: 12\n── Column specification ────────────────────────────────────────────────────────\nDelimiter: \";\"\nchr  (1): gauge_id\ndbl (11): soil_depth_pelletier, soil_depth_statsgo, soil_porosity, soil_cond...\n\nℹ Use `spec()` to retrieve the full column specification for this data.\nℹ Specify the column types or set `show_col_types = FALSE` to quiet this message.\n\ntopo &lt;- read_delim(\"data/camels_topo.txt\", delim = \";\")\n\nRows: 671 Columns: 7\n── Column specification ────────────────────────────────────────────────────────\nDelimiter: \";\"\nchr (1): gauge_id\ndbl (6): gauge_lat, gauge_lon, elev_mean, slope_mean, area_gages2, area_geos...\n\nℹ Use `spec()` to retrieve the full column specification for this data.\nℹ Specify the column types or set `show_col_types = FALSE` to quiet this message.\n\nvege &lt;- read_delim(\"data/camels_vege.txt\", delim = \";\")\n\nRows: 671 Columns: 10\n── Column specification ────────────────────────────────────────────────────────\nDelimiter: \";\"\nchr (2): gauge_id, dom_land_cover\ndbl (8): frac_forest, lai_max, lai_diff, gvf_max, gvf_diff, dom_land_cover_f...\n\nℹ Use `spec()` to retrieve the full column specification for this data.\nℹ Specify the column types or set `show_col_types = FALSE` to quiet this message.\n\ncamels &lt;- reduce(list(clim, geol, hydro, soil, topo, vege), full_join, by = \"gauge_id\")\n\nggplot(data = camels, aes(x = gauge_lon, y = gauge_lat)) +\n  borders(\"state\", colour = \"gray50\") +\n  geom_point(aes(color = q_mean)) +\n  scale_color_gradient(low = \"pink\", high = \"dodgerblue\") +\n  ggthemes::theme_map() +\n  labs(title = \"CAMELS Sites Colored by Mean Flow (q_mean)\",\n       x = \"Longitude\", y = \"Latitude\",\n       color = \"Mean Flow\")"
  },
  {
    "objectID": "index.html#question-2",
    "href": "index.html#question-2",
    "title": "Lab 6",
    "section": "Question #2",
    "text": "Question #2\n\nlibrary(patchwork)\n\nmap_p &lt;- ggplot(camels, aes(x = gauge_lon, y = gauge_lat)) +\n  borders(\"state\", colour = \"gray60\") +\n  geom_point(aes(color = p_mean), size = 2) +\n  scale_color_viridis_c(option = \"D\") +\n  coord_fixed(1.3) +  # &lt;- this is the fix!\n  ggthemes::theme_map() +\n  labs(title = \"Mean Precipitation (p_mean)\",\n       color = \"mm/day\")\n\nmap_a &lt;- ggplot(camels, aes(x = gauge_lon, y = gauge_lat)) +\n  borders(\"state\", colour = \"gray60\") +\n  geom_point(aes(color = aridity), size = 2) +\n  scale_color_viridis_c(option = \"C\") +\n  coord_fixed(1.3) +  # &lt;- fix here too\n  ggthemes::theme_map() +\n  labs(title = \"Aridity Index (PET / P)\",\n       color = \"Aridity\")\n\nmap_p + map_a"
  },
  {
    "objectID": "index.html#model-building",
    "href": "index.html#model-building",
    "title": "Lab 6",
    "section": "Model Building",
    "text": "Model Building\n\nlibrary(tidymodels)\n\n\ncamels_mod &lt;- camels %&gt;%\n  select(where(is.numeric)) %&gt;%\n  drop_na()\n\n\nset.seed(330)\nsplit &lt;- initial_split(camels_mod, prop = 0.8)\ntrain &lt;- training(split)\ntest &lt;- testing(split)\n\n\nrec &lt;- recipe(q_mean ~ ., data = train) %&gt;%\n  step_normalize(all_predictors())\n\n\nlm_mod &lt;- linear_reg() %&gt;% set_engine(\"lm\")\nrf_mod &lt;- rand_forest(mode = \"regression\") %&gt;% set_engine(\"ranger\")\nxgb_mod &lt;- boost_tree(mode = \"regression\") %&gt;% set_engine(\"xgboost\")\n\n\nmodels &lt;- workflow_set(\n  preproc = list(base = rec),\n  models = list(LM = lm_mod, RF = rf_mod, XGB = xgb_mod)\n)\n\nresamples &lt;- vfold_cv(train, v = 5)\n\n\nresults &lt;- models %&gt;%\n  workflow_map(\"fit_resamples\", resamples = resamples, metrics = metric_set(rmse, rsq))\n\n\ncollect_metrics(results) %&gt;% \n  select(wflow_id, .metric, mean, std_err)\n\n# A tibble: 6 × 4\n  wflow_id .metric  mean std_err\n  &lt;chr&gt;    &lt;chr&gt;   &lt;dbl&gt;   &lt;dbl&gt;\n1 base_LM  rmse    0.167 0.00498\n2 base_LM  rsq     0.988 0.00120\n3 base_RF  rmse    0.283 0.0323 \n4 base_RF  rsq     0.971 0.00424\n5 base_XGB rmse    0.207 0.0249 \n6 base_XGB rsq     0.982 0.00338\n\n\n\nfinal_lm &lt;- workflow() %&gt;%\n  add_recipe(rec) %&gt;%\n  add_model(lm_mod) %&gt;%\n  fit(data = train)\n\n\nlm_preds &lt;- predict(final_lm, test) %&gt;%\n  bind_cols(test)\n\nmetrics(lm_preds, truth = q_mean, estimate = .pred)\n\n# A tibble: 3 × 3\n  .metric .estimator .estimate\n  &lt;chr&gt;   &lt;chr&gt;          &lt;dbl&gt;\n1 rmse    standard       0.148\n2 rsq     standard       0.989\n3 mae     standard       0.104\n\nggplot(lm_preds, aes(x = q_mean, y = .pred)) +\n  geom_point(alpha = 0.6) +\n  geom_abline(slope = 1, intercept = 0, color = \"red\", linetype = \"dashed\") +\n  labs(title = \"Test Set: Predicted vs Observed q_mean (Linear Model)\",\n       x = \"Observed q_mean\",\n       y = \"Predicted q_mean\")"
  },
  {
    "objectID": "index.html#question-3",
    "href": "index.html#question-3",
    "title": "Lab 6",
    "section": "Question #3",
    "text": "Question #3\n\nlibrary(baguette)\n\nnn_mod &lt;- bag_mlp(mode = \"regression\") %&gt;%\n  set_engine(\"nnet\")\n\n\nmodels_all &lt;- workflow_set(\n  preproc = list(base = rec),\n  models = list(\n    LM = lm_mod,\n    RF = rf_mod,\n    XGB = xgb_mod,\n    NN = nn_mod\n  )\n)\n\n# Fit with cross-validation\nresults_all &lt;- models_all %&gt;%\n  workflow_map(\"fit_resamples\", resamples = resamples, metrics = metric_set(rmse, rsq))\n\n\ncollect_metrics(results_all) %&gt;%\n  select(wflow_id, .metric, mean, std_err)\n\n# A tibble: 8 × 4\n  wflow_id .metric  mean std_err\n  &lt;chr&gt;    &lt;chr&gt;   &lt;dbl&gt;   &lt;dbl&gt;\n1 base_LM  rmse    0.167 0.00498\n2 base_LM  rsq     0.988 0.00120\n3 base_RF  rmse    0.281 0.0371 \n4 base_RF  rsq     0.971 0.00512\n5 base_XGB rmse    0.207 0.0249 \n6 base_XGB rsq     0.982 0.00338\n7 base_NN  rmse    0.252 0.0146 \n8 base_NN  rsq     0.972 0.00302\n\n\nAfter adding a neural net model, I compared linear, RF, XGBoost, and NN. Linear regression still performed the best overall with the lowest RMSE and highest R². The neural net and XGBoost were close behind, but the simplicity and strong performance of the linear model makes it the best choice for this dataset."
  },
  {
    "objectID": "about.html",
    "href": "about.html",
    "title": "About",
    "section": "",
    "text": "About this site\n\n1 + 1\n\n[1] 2"
  }
]